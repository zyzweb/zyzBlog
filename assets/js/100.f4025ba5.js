(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{544:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"用npm-pm2-部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用npm-pm2-部署"}},[t._v("#")]),t._v(" 用npm + pm2 部署")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-g")]),t._v(" verdaccio\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /root/.config/verdaccio/config.yaml\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#在配置文件的最后一行加上listen: 0.0.0.0:4873, 默认没有这一行的，只能在本机访问，添加后可以通过外网访问")]),t._v("\n\n\nnrm "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" myTencentCloud http://42.193.248.139:4873/  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加源")]),t._v("\nnrm use myTencentCloud  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#使用源")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" adduser "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--registry")]),t._v(" http://42.193.248.139:4873/   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#添加用户  设置用户名和密码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("whoami")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#确认是否添加成功")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" publish "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--registry")]),t._v(" http://42.193.248.139:4873/   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#发布  ")]),t._v("\n")])])]),s("h3",{attrs:{id:"用docker部署-docker可以-docker-compose暂时有问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用docker部署-docker可以-docker-compose暂时有问题"}},[t._v("#")]),t._v(" 用docker部署  (docker可以,docker-compose暂时有问题)")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull verdaccio/verdaccio  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#拉取镜像")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" verdaccio "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4873")]),t._v(":4873 verdaccio/verdaccio  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#启动容器")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#docker-compose.yml (暂时有问题)")]),t._v("\nversion: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3'")]),t._v("\nservices:\n  verdaccio:\n    image: verdaccio/verdaccio\n    container_name: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"verdaccio"')]),t._v("\n    network--mode: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bridge"')]),t._v("\n    environment:\n      - "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("VERDACCIO_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4873")]),t._v("\n    ports:\n      - "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4873:4873"')]),t._v("\n    volumes:\n      - "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/home/verdaccio/storage:/verdaccio/storage"')]),t._v("\n      - "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/home/verdaccio/conf:/verdaccio/conf"')]),t._v("\n      - "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/home/verdaccio/plugins:/verdaccio/plugins"')]),t._v("  \n    network_mode: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bridge"')]),t._v("\n")])])]),s("h3",{attrs:{id:"常用配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用配置"}},[t._v("#")]),t._v(" 常用配置")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 素有包的保存路径")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /verdaccio/storage/data\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 插件的保存路径")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("plugins")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /verdaccio/plugins\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过web访问")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("web")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Verdaccio\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 账号密码文件，初始不存在")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("auth")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("htpasswd")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /verdaccio/storage/htpasswd\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# max_users：1000")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 默认1000，允许用户注册数量。为-1时，不能通过 npm adduser 注册，此时可以直接修改 file 文件添加用户。")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 本地不存在时，读取仓库的地址")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uplinks")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("npmjs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" https"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//registry.npmjs.org\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对包的访问操作权限，可以匹配某个具体项目，也可以通配")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# access 访问下载；publish 发布；unpublish 取消发布；")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# proxy 对应着uplinks名称，本地不存在，去unplinks里取")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# $all 表示所有人都可以执行该操作")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# $authenticated 已注册账户可操作")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# $anonymous 匿名用户可操作")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 还可以明确指定 htpasswd 用户表中的用户，可以配置一个或多个。")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("packages")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("'@*/*'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("access")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $all\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("publish")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $authenticated\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("unpublish")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $authenticated\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npmjs\n    \n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("'**'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("access")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $all\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("publish")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $authenticated\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("unpublish")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $authenticated\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" npmjs\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 服务器相关")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("sever")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("keepAliveTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("middlewares")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("audit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日志设定")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" stdout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pretty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("level")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"参考链接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[t._v("#")]),t._v(" 参考链接")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://verdaccio.org/zh-CN/docs/what-is-verdaccio",target:"_blank",rel:"noopener noreferrer"}},[t._v("verdaccio中文文档"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://developer.aliyun.com/article/906143",target:"_blank",rel:"noopener noreferrer"}},[t._v("npm私服搭建—verdaccio方案及其最佳实践"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);