(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{527:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("pm2(Process Manager 2)是一个node包,是node程序的部署神器,支持多种脚本语言（ruby，python，bash等等）")]),s._v(" "),t("p",[s._v("提供了性能/进程实时监控，负载均衡（仅限于node.js），自动重启，日志管理等等")]),s._v(" "),t("p",[s._v("是脚本的进程管理,可以加入开机自启和关闭自启")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#pm2启动的服务都是在后台运行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置文件  ~/.pm2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pm2 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#全局安装pm2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" pm2 startup  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把pm2加入开机启动(由于需要修改plist需要sudo权限) 加入新的任务都要执行 pm2 save sudo pm2 startup")]),s._v("\npm2 unstartup  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移除开机自启动")]),s._v("\npm2 update "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#更新")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看")]),s._v("\npm2 list "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看所有pm2任务")]),s._v("\npm2 logs "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看日志")]),s._v("\npm2 show app_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("app_id "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看进程详情")]),s._v("\npm2 monit  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看CPU和内存资源占用")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启")]),s._v("\npm2 restart app_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("app_id  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启")]),s._v("\npm2 restart all  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启所有进程，相当stop+start")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除")]),s._v("\npm2 delete app_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("app_id "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除pm2任务")]),s._v("\npm2 delete all "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从列表中删除全部进程")]),s._v("\npm2 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 杀死守护进程")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止")]),s._v("\npm2 stop app_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("app_id\npm2 stop all  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止所有")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动")]),s._v("\npm2 start app.js  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动  或者 pm2 start ./index.js")]),s._v("\npm2 start app.js "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动4个应用实例，自动负载均衡")]),s._v("\npm2 start app.js "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--watch")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监听文件变化，配合pm2 logs，方便本地开发")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#批量启动(以restart模式启动，可以多次执行)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新建server.json")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"apps"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"appA"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"script"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./appA.js"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"watch"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"appB"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"script"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./appB.js"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"watch"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再执行：")]),s._v("\npm2 start server.json\n")])])]),t("h3",{attrs:{id:"参考链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/sinat_17775997/article/details/116190210",target:"_blank",rel:"noopener noreferrer"}},[s._v("pm2冷门技巧"),t("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);