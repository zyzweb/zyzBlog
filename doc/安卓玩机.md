# 安卓玩机

## root刷机通用过程

1. **获取BootLoader权限（即解锁手机BL)**
2. **fastboot模式下刷入TWRP**
3. **刷入第三方rom**

## 小米手机刷机过程

1. **解BL锁**
2. **线刷官方最新的开发版 **
3. **刷入最新的TWRP**  小米9 recovery mi recovery 3.0
4. **刷入第三方rom**

## 缩写

**TWRP** TeamWin Recovery Project 为GUI系统,目前最主要的**第三方Recovery**支持触摸，而且在3.0版本之后，默认开启MTP模式，可以方便的管理手机中的文件甚至最新版本，已经集成ROOT和各种满足用户需求的常用小功能,[源码地址](https://github.com/omnirom/android_bootable_recovery/)

**AOT** ahead of time  提前编译

**JIT**  just in time  时时编译

**ART** Android runtime android4.4增加的一种应用运行模式 传统Dalvik模式

**FCM**（Firebase Cloud Messaging）取代GCM(Google Cloud Messaging) 都是谷歌的消息推送服务

**ADB**  Android Debug Bridge  安卓调试模式

**PTP**  Picture Transfer Protocol  图片传输协议

**MTP**  Media Transfer Protocol  媒体传输协议

**ROM**  Read-Only Memory 只读储存器

**RAM**  Random Access Memory  随机读取储存器

**激活**： 它有一个服务器，网络的，开放之后，联网，输入KEY，会记录你的硬件和系统，并且 发送一个指令，可以游戏！在一台机器上可以无限次激活的意思是： 假如你把游戏删除了，或者坏掉了，只要你的硬件和系统没变，能对的上，就可以直接再次激活，次数不限！

**反激活**：比如你打算 把这个游戏 放到另一个机器上玩，换硬件，换系统也一样，或者 你玩结束了，打算卖掉给别人的机器玩，就需要 反激活，反激活也要联网，目的就是 消除 你说记录在激活服务器里的信息。

**阻止运行**是一款 Android 系统上依赖 Xposed 框架运行的插件。通过劫持几个系统API，阻止程序在你不使用时运行,安卓5.0之后随着ART之后改名为黑域,不依赖xposed,采用补丁模式

**打补丁**就是修改系统目录文件,劫持系统API

### **安卓浏览器**

1. upx浏览器 免费vpn 
2. 雨见 浏览器  免费vpn  解析视频  百度云资源  资源嗅探
3. 火狐手机版  油猴插件
4. Alook 类似ios的Alook
5. 夸克浏览器

### **太极模块**

- 微信增强  
- 畅玩微信(风险高)
- 运动修改器

magisk(面具)  全局模式的针对所有应用的,临时生效

银行类app会检测是否使用xposed

作用于系统的模块需要重启

**太极阴(exposed)**

太极版本和太极模块最好是最新版本  面具稳定运行就行

太极面具模块是面具app的一个模块



## 劫持原理

- Xposed 通过劫持 Android 系统的 **zygote** 进程来加载自定义功能，这就像是半路截杀，在应用运行之前就已经将我们需要的自定义内容强加在了系统进程当中。

- Magisk 则另辟蹊径，通过挂载一个与系统文件相隔离的文件系统来加载自定义内容，为系统分区打开了一个通往平行世界的入口，所有改动在那个世界（Magisk 分区）里发生，在必要的时候却又可以被认为是（从系统分区的角度而言）没有发生过

<img src="https://gitee.com/zyzcode/gitee-pic/raw/master/image-20210715170605342.png" alt="image-20210715170605342" style="zoom: 25%;" />

- 验证系统完整性才能进行OTA升级  Magisk 可以被看作是一种文件系统

## 注意点:

- 各大厂商的 Fastboot / Bootloader 模式都不同,为了使得自己有更多的自主权
- 验证系统完整性才能进行OTA升级,使用第三方rec可以升级系统,升级之后需要重刷rec,刷rec数据会保存
- 双清只能清除应用数据 不能清除个人数据 第三方rec不能自动解密data需要格式化data
- 安装zip卡刷包和执行adb都会修改系统分区
- root可设置为系统app
- su不能和magisk共存
- Android 7.0引入A/B机制 更新的B 重启切换回B
- Android 8.0  [Project Treble](https://sspai.com/post/40890) 能更快的获得更新
- 首先卸载掉所有在太极中创建过的APP（请注意备份数据），然后卸载太极即可。如果你开启了阴阳之门，需要先在去 关于-关闭阴阳之门，然后才能卸载。
- 小米9不支持A/B分区
- Magisk Hide 隐藏root
- ttf wolf格式 [更改字体](http://www.sohu.com/a/305962942_115785)
- 刷入第三方rec之后才能刷第三方rom
- 看有没有回滚机制
- 
- Packet Capture 无ROOT抓包

## 常见路径

- /storage/emulated/0   储存卡路径
- /storage/emulated/0/Download  Alook下载
- /sdcard/Android/data/com.tencent.mm/MicroMsg/Download/   微信接收的文件

## **adb和fastboot命令**

```bash
#adb命令
adb devices  #列出adb设备
adb reboot  #重启设备
adb reboot bootloader  #重启到fastboot模式
adb reboot recovery  #重启到recovery模式
adv reboot edl  #重启到edl模式
adb -d shell sh /data/data/me.piebridge.brevent/brevent.sh   #黑域开启

#fastboot命令
fastboot devices  #列出fastboot设备
fastboot reboot #重启设备
fastboot reboot-bootloader #重启到fastboot模式
fastboot flash <分区名称> <镜像文件名>  #刷写分区
fastboot oem reboot-<模式名称>  #重启到相应模式
fastboot oem device-info  #查看解锁状态
```

## xposed框架变迁

**xposed--太极--exposed--lsposed**

下载[magisk最新版](https://github.com/topjohnwu/Magisk/releases)然后安装[Riru](https://github.com/RikkaApps/Riru/releases)在googleplay下载lsposed就可以使用了

# recovery edl fastboot 3种模式

- **fastboot** 主要是用来与bootloader的USB通讯的PC命令行工具。 他一般主要也用来向bootloader传送刷机文件进行文件分区重烧。 因此在使用时，必须有一个PC机并且USB线要始终联着。 所以这种方式称为线刷

- **recovery**  类似 windows pe和dos
- **edl**  即高通模式9008模式,救砖才用
- 

## 文件管理APP ES文件浏览器 VS Root Explore

- ES文件浏览器  有快传  可以查看压缩内容

- Root Explorer 可以搜索文件  可以查看所有文件

## 太极

太极可以兼容xposed模块

太极阴修改了app签名太极阳没有修改签名

太极阴就像是个虚拟机

给予自启动权限，省电优化，加入系统内存清理白名单，允许自启

## 其他好用的软件

- 钛备份可以卸载和冻结系统应用   过滤器可以创建标签
- apk提取器
- termux

## 好用的模块

- wifi模拟器(太极)
- 绿色守卫(控制后台进程) (太极)
- [模拟位置](https://tc5.us/file/19604958-367085914)(太极) 在模拟位置指定app设置好要模拟的地点(顺便还能查经纬度),退出要模拟的应用重新打开就可以了

### 去广告的几种方法

1. 八戒 - 无需 root，只需要辅助服务  模拟点击
2. 悟空 - 需要 Xposed  悟空及替换规则，首次进入先不勾选，引导和登陆账号完成后再勾选执行
3. hosts 管理 - 需要 root (替换/system/etc/hosts)  通过hosts及url拦截需清缓存
4. 文件替换 - 需要 root  找到广告文件后用同名的空文件夹替换 (替换是删除--创建--修改文件)
5. 使用大圣净化app

### 小米防止锁定后台

1. 按菜单键下拉应用，加锁，这样不会被一键清理
2. 神秘模式 (设置--电量和性能--神隐模式--应用配置--大圣净化--设置为无限制)
3. 开机自启动 (安全中心--授权管理--自启动管理--大圣净化--设置为开启)

### 相关链接和资源

[magisk介绍](https://sspai.com/post/53043)

[安卓玩机指南](https://sspai.com/post/44933)

[国外XDA](https://www.xda-developers.com/)

[国内酷安](https://www.coolapk.com/)  

[twrp源码](https://github.com/omnirom/android_bootable_recovery/)

酷客fans(微信公众号)

miui论坛](https://www.xiaomi.cn/)

 [IT之家](https://www.ithome.com/)

[小米9刷rec](http://www.romleyuan.com/lec/read?id=93)

[控制自启动](https://zhuanlan.zhihu.com/p/45673600)

[riruv25.4.4](https://wwa.lanzoui.com/iGA8Drgh8gj)

[太极下载地址](https://taichi.cool/zh/download.html)

[太极文档](https://taichi.cool/zh/)

[autojs](https://hyb1996.github.io/AutoJs-Docs/#/)(类似ios的jsbox和pc的按键精灵)

