解决跨域的2个插件

requestly    [access-control-allow-origin](https://chrome.google.com/webstore/detail/allow-cors-access-control/lhobafahddgcelffkeicbaginigeejlf/related?hl=en-US)

requestly用法:

```shell
Access-Control-Allow-Origin: https://cdnsit.jyblife.com   #请求跨域 要发送cookie不能设为*
Access-Control-Allow-Methods: POST, GET, OPTIONS  #服务器支持的所有跨域请求的方法
Access-Control-Allow-Headers: X-PINGOTHER, Content-Type #如果包含Access-Control-Request-Headers字段，则Access-Control-Allow-Headers字段是必需
Access-Control-Allow-Credentials: true   # 否允许发送Cookie
# 预检请求头信息
Access-Control-Request-Headers: X-Custom-Header(自定义)  #指定浏览器CORS请求会额外发送的头信息字段
Access-Control-Request-Method: POST   #用来列出浏览器的CORS请求会用到哪些HTTP方法

Access-Control-Max-Age: 86400   #本次预检请求的有效期，单位为秒
access-control-expose-headers:111  # XMLHttpRequest.getResponseHeader()的其他
```

引荐来源网址政策

strict-origin-when-cross-origin 跨域是refer只会展示origin不会展示完整地址

no-referrer-when-downgrade    https协议降为http协议时不发送referrer给跳转网站的服务器



Chrome 计划在85版开始 将其切换默认策略 no-referrer-when-downgrade 更换到 strict-origin-when-cross-origin



从 `https://site-one.example/stuff/detail?tag=red` 访问 `https://site-two.example/…`

- 使用 `no-referrer-when-downgrade`: Referer: `https://site-one.example/stuff/detail?tag=red`。
- 使用 `strict-origin-when-cross-origin`: Referer: `https://site-one.example/`

**不变**

- 和 `no-referrer-when-downgrade` 一样， `strict-origin-when-cross-origin` 在从 `HTTPS` 来源访问 `HTTP` 站点时，不会携带 `Referer` 头。
- 在相同的来源内，`Referer` 标头值为完整的 `URL`



显示的是预配标头





axios.request要这种写法,发送简单请求,公司只对post做了跨域限制没对options做跨域限制

headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        }



### 问题

![image-20220223184642732](http://image.zhuyuanzheng1.top/image-20220223184642732.png)

![image-20220223184731732](http://image.zhuyuanzheng1.top/image-20220223184731732.png)

触发了复杂请求但是options请求却没有设置Access-Control-Allow-Origin

设置响应头 Content-Type': 'application/x-www-form-urlencoded'





![image-20220225150013475](http://image.zhuyuanzheng1.top/image-20220225150013475.png)

<img src="http://image.zhuyuanzheng1.top/image-20220225150046003.png" alt="image-20220225150046003" style="zoom:30%;" />

返回的是json数据,content-Type为text/plain就触发了CORB




### 相关链接

[关闭私域跨域](https://zhuanlan.zhihu.com/p/414533145)

[简单跨域-西岭老湿](https://zhuanlan.zhihu.com/p/53996160)

[阮一峰-cors](https://www.ruanyifeng.com/blog/2016/04/cors.html)

